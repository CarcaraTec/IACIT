<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Configurações</title>
        <link rel="icon" href="https://thumbs2.imgbox.com/df/ce/F2WYfCpq_t.jpg">
        <link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" />
        <link href="./css/styles.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
        <script src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script src="./unlog.js" defer></script>
            <script src="./config.js" defer></script>
        <!--IMPORT SELECT2-->
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <script>
        $(document).ready(function() {
        $(".est-select").select2();
        });
        </script>
    </head>
    <style>
        .vertical {
            border-left: 3px solid gainsboro;
            height: 95vh;
            position:absolute;
            left: 105%;
            border-radius: 10px;
        }
    </style>
    <script>

$(function() {
        $.getJSON("https://api.ipify.org?format=jsonp&callback=?",
          function(json) {
            console.log(json.ip)
$(document).ready(function(){
    $.getJSON("/log",function(log){
        const userLog = log.reverse();
            function isCherries(fruit){
                return fruit.ip === json.ip;
                }
              logUser = userLog.find(isCherries);
                console.log(log.status)
              if(logUser === undefined || logUser.status == "deslogado"){
                window.location.href = "login.html";
              }


              $(document).ready(function(){
                              $.getJSON("/usuarios",function(data){
                                    const inventory = data;
                                    function isCherries(fruit){
                                        return fruit.email === logUser.email;
                                        }
                                        
                                    var usuario = inventory.find(isCherries);

    $(document).ready(function(){
    $.getJSON("/log/getUsuario/"+data.email,function(user){

        $("#email1").append(user.email);
        $("#nome").append(user.nome);
        $("#email1").append(user.sobrenome);
        document.getElementById('email1').value = user.sobrenome;
        document.getElementById('telefone').value = user.telefone;
        document.getElementById('cpf').value = user.cpf;
        document.getElementById('data').value = user.dataNasc;
        document.getElementById('cargo').value = user.cargo;

    });
});
});
});
          });
        });
    });
        });
    function trocarImg(){
        var url = document.getElementById('recipient-url').value;
        var img = document.querySelector("#image-profile");
        img.setAttribute('src', "https://scontent.fcgh4-1.fna.fbcdn.net/v/t39.30808-6/270061477_2019098048246248_8482030674157399645_n.jpg?_nc_cat=106&ccb=1-7&_nc_sid=09cbfe&_nc_eui2=AeH4S1nC_JAix3fbzq_o8_aeyLiVrbxWdibIuJWtvFZ2JoQopVV3ISAxzrGxxjgkCo5E7Q-QYV4puiQsjgod39yL&_nc_ohc=jPEqWRk5x7gAX834I6h&_nc_zt=23&_nc_ht=scontent.fcgh4-1.fna&oh=00_AfDUrEzO_NKLQPBtbjBCymtrmurrux0uxp_0IzzmRmKAeg&oe=639437F4");
        }
        trocarImg()
    </script>
    <body class="sb-nav-fixed">
        <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
            <!-- Navbar Brand-->
            <div>1</div>
            <a class="navbar-brand ps-3" href="index.html">IACIT</a>
            <!-- Sidebar Toggle-->
            <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
            <!-- Navbar Search-->
            <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                <div class="ls-field-lg">
                    <select class="est-select" style="width:300px" id="estacoes-select">
                        <option id="select1" value="abc" disabled="" selected="">Procurar...</option>
                    </select>
                    <script>
                        $(document).ready(function(){
                            $.getJSON("/estacoes",function(data){
                                const dado = doc.split('=');
                                const estacoesSelect = document.getElementById("estacoes-select");
                                var estacoesList = [];
                                for (var i = 0; i<data.length; i++){
                                estacoesList.push(data[i].nome_estacao+" - |"+data[i].codigo+"|");
                                }
                                estacoesList.forEach((estacoes) => {
                                  option = new Option(estacoes, estacoes.toLowerCase());
                                  estacoesSelect.options[estacoesSelect.options.length] = option;
                                });
                                });
                                });
                    </script>
                    <button class="btn btn-primary" id="btnNavbarSearch" type="button" onclick="search()"><i class="fas fa-search"></i></button>
                    <script>
                            function search(){
                            var estacao = document.getElementById('estacoes-select').value;
                            const words = estacao.split('|');
                            window.location.href = "charts=precipitacao="+words[1].toUpperCase()+"=01-01-2021=31-01-2021";
                        }
                    </script>
                </div>
            </form>
            <!-- Navbar-->
            <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li id="labelHome" class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#!">Meu Perfil</a></li>
                        <li><a class="dropdown-item" href="#!">Atividades</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <form name="unlog" action="">
                        <li><button class="dropdown-item" onclick="deslogar()">Logout</button></li>
                        </form>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <div class="sb-sidenav-menu-heading">HOME</div>
                            <a class="nav-link" href="index.html">
                                <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                                IACIT
                             </a>
                            <!-- <div class="sb-sidenav-menu-heading">Interface</div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseLayouts" aria-expanded="false" aria-controls="collapseLayouts">
                                <div class="sb-nav-link-icon"><i class="fas fa-columns"></i></div>
                                Layouts
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseLayouts" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="layout-static.html">Static Navigation</a>
                                    <a class="nav-link" href="layout-sidenav-light.html">Light Sidenav</a>
                                </nav>
                            </div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapsePages" aria-expanded="false" aria-controls="collapsePages">
                                <div class="sb-nav-link-icon"><i class="fas fa-book-open"></i></div>
                                Pages
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a> 
                            <div class="collapse" id="collapsePages" aria-labelledby="headingTwo" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav accordion" id="sidenavAccordionPages">
                                    <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#pagesCollapseAuth" aria-expanded="false" aria-controls="pagesCollapseAuth">
                                        Authentication
                                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                                    </a>
                                    <div class="collapse" id="pagesCollapseAuth" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordionPages">
                                        <nav class="sb-sidenav-menu-nested nav">
                                            <a class="nav-link" href="login.html">Login</a>
                                            <a class="nav-link" href="register.html">Register</a>
                                            <a class="nav-link" href="password.html">Forgot Password</a>
                                        </nav>
                                    </div>
                                    <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#pagesCollapseError" aria-expanded="false" aria-controls="pagesCollapseError">
                                        Error
                                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                                    </a>
                                    <div class="collapse" id="pagesCollapseError" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordionPages">
                                        <nav class="sb-sidenav-menu-nested nav">

                                        </nav>
                                    </div>
                                    
                                </nav>
                                
                            </div>
                            --> 
                            <div class="sb-sidenav-menu-heading">Visualização</div> 
                            <a class="nav-link" href="charts.html">
                                <div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
                                Gráficos
                            </a>
                            <!--<a class="nav-link" href="tables.html">
                                <div class="sb-nav-link-icon"><i class="fas fa-table"></i></div>
                                Tables
                            </a>-->
                        </div>
                    </div>
                    <div class="sb-sidenav-footer">
                        <div class="small">Logado como:</div>
                        <div id="nomeUsuario"></div>
                    </div>
                </nav>
            </div>

            <div id="layoutSidenav_content">
                <form name="configForm" action="">
                    <div class="container rounded bg-white mt-5 mb-5">
                        <div class="row">
                            <div class="col-md-3 border-right">
                                <div class="d-flex flex-column align-items-center text-center p-3 py-5"><img id="image-profile" class="rounded-circle mt-5" type="button" width="150px" src="https://img.freepik.com/vetores-premium/homem-perfil-caricatura_18591-58482.jpg?w=740" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><span id="nome1" class="font-weight-bold"></span><span class="text-black-50" id="email" value="edogaru@mail.com.my"></span><span> </span></div>


                            </div>
                            <div class="col-md-5 border-right">
                                <div class="p-3 py-5">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h4 class="text-right">Meu Perfil</h4>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-6"><label class="labels">Nome</label><input id="nome" type="text" class="form-control" placeholder="Nome" value="" disabled="disabled"></div>

                                        <input id="email1" type="hidden" class="form-control" placeholder="Nome" value="">
                                        <div class="col-md-6"><label class="labels">Sobrenome</label><input id="sobrenome" type="text" class="form-control" value="" placeholder="dos Santos Rodrigues" disabled="disabled"></div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-md-12"><label class="labels">Telefone</label><input id="telefone" type="text" class="form-control" placeholder="12983211612" value="" disabled="disabled"></div>
                                        <div class="col-md-12"><label class="labels">CPF</label><input id="cpf" type="text" class="form-control" placeholder="49336499874" value="" disabled="disabled"></div>
                                        <div class="col-md-12"><label class="labels">Data de Nascimento</label><input id="data" type="text" class="form-control" placeholder="16/12/1999" value="" disabled="disabled"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3 py-5">
                                    <div class="mb-5"></div>
                                    <div class="col-md-12"><label class="labels">Cargo</label><input id="cargo" type="text" class="form-control" placeholder="ADM" value="" disabled="disabled"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">URL da imagem</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="mb-3">
                                <label for="recipient-url" class="col-form-label">URL</label>
                                <input type="text" class="form-control" id="recipient-url">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="trocarImg()">Salvar</button>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" crossorigin="anonymous"></script>
    </body>
</html>
